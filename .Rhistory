library(tidyverse)
library(tidyverse);library(psych);library(tidyr);library(sem)
reap <- read_csv("HainesEtAI_data.csv")
reap <- read_csv("HainesEtAl_data.csv")
edit(reap)
data.frame(reap)
edit(reap)
as.data.frame(reap)
edit(reap)
head(reap)
View(reap)
View(reap)
str(reap)
library(tidyverse);library(psych);library(tidyr);library(sem); library(lavaan)
wisdom <- read_csv("HainesEtAl_data.csv")
head(wisdom)
as.data.frame(wisdom)
wisdom %>% select(SEMA_ID, Time, CTRLcln, REAP, REAP_1, ZBFI_N, ZDASS_D, ZDASS_A,
ZDASS_S, ZRSE, ZSOCANX, CTRL_M) -> main_wis
#lmer package로 해보기
#install.packages("lmerTest")
library(nlme);library(lme4);library(lmerTest)
intercept.only.model <- lmer(REAP ~ 1 + ( 1 | SEMA_ID), data=main_wis) #fitting
summary(intercept.only.model)
ranef(intercept.only.model) #each regression for ID
(ICCs = 285.5/(285.5 + 341.0)) #ICCs
ranova(intercept.only.model) #significance test for the intercept variance, ccompared with null model
# FALSE `geom_smooth()` using formula 'y ~ x' #plot..?
random.intercept.model <- lmer(REAP ~ CTRLcln + Time + REAP_1 + (1 | SEMA_ID), data = main_wis, REML = T)
summary(random.intercept.model)
ranef(random.intercept.model) #each regression for ID
(explained_lv1 <- (341.0 - 323.1)/341.0) #explained level1 variance
(explained_T <- ((285.5 + 341.0)-(173.7+323.1))/(285.5 + 341.0)) #explained total variance
context.model <- lmer(REAP ~ CTRLcln + Time + REAP_1 + CTRL_M + ZDASS_D +(1 | SEMA_ID), data = main_wis, REML = T)
summary(context.model)
intercept.as.outcome.model <- lmer(REAP ~ CTRLcln + Time + REAP_1 + CTRL_M + ZDASS_D +(1 | SEMA_ID), data = main_wis, REML = T)
random.coefficients.model <- lmer(REAP ~ CTRLcln + Time + REAP_1 + (CTRLcln + Time + REAP_1 | SEMA_ID), data = main_wis, REML = T)
summary(random.coefficients.model)
ranova(random.coefficients.model)
context.model <- lmer(REAP ~ CTRLcln + Time + REAP_1 + (CTRL_M + ZDASS_D | SEMA_ID), data = main_wis, REML = T)
summary(context.model)
main_wis %>% mutate(ID = as.factor(ID)) -> main_wis
main_wis %>% mutate(ID = as.factor(SEMA_ID)) -> main_wis
cols(ID = col_double(), REAP = col_double(), Time = col_double(), REAP_1 = col_double())
glimpse(main_wis)
intercept.only <- lme(REAP ~ 1,
random = ~1 | ID,
main_wis, method = "ML")
summary(intercept.only)
intercept.only <- lme(REAP ~ 1,
random = ~1 | ID,
main_wis, method = "ML")
intercept.only <- lme(REAP ~ 1,
random = ~1 | ID,
main_wis, method = "ML")
intercept.only <- lme(REAP ~ 1,
random = ~1 | ID,
main_wis, method = "ML", na.action = na.omit)
summary(intercept.only)
summary(intercept.only.model)
VarCorr(intercept.only)
random.intercept <- lme(REAP ~ CTRLcln + Time + REAP_1,
random = ~1 | ID,
main_wis, method = "ML", na.action = na.omit)
summary(random.intercept)
VarCorr(random.intercept)
random.coefficients <- lme(REAP ~  CTRLcln + Time + REAP_1,
random = ~ CTRLcln + Time + REAP_1 | ID,
main_wis, method = "ML", na.action = na.omit)
summary(random.coefficients)
VarCorr(random.coefficients)
ranef(random.coefficients)["REAP"] %>% round(2) %>% tail(20)
View(main_wis)
ranef(random.coefficients)["CTRLcln"] %>% round(2) %>% tail(20)
anova(random.coefficients, random.intercept)
#slope-as-outcome model
slope.outcome <- lme(REAP ~  CTRLcln*ZDASS_D + Time*ZDASS_D + REAP_1*ZDASS_D + CTRLcln*CTRL_M + Time*CTRL_M + REAP_1*CTRL_M,
random = ~ CTRLcln + Time + REAP_1 | ID,
main_wis, method = "ML", na.action = na.omit)
summary(slope.outcome)
summary(slope.outcome)
summary(random.coefficients)
summary(slope.outcome)
summary(slope.outcome)
VarCorr(slope.outcome)
intercept.outcome <- lme(REAP ~ CTRLcln + Time + REAP_1 + ZDASS_D + CTRL_M,
random = ~ CTRLcln + Time + REAP_1 | ID,
main_wis, method = "ML", na.action = na.omit)
summary(intercept.outcome)
VarCorr(intercept.outcome)
intercept.slope.outcome <- lme(REAP ~  CTRLcln + Time + REAP_1 + ZDASS_D + CTRL_M + CTRLcln*ZDASS_D + Time*ZDASS_D + REAP_1*ZDASS_D + CTRLcln*CTRL_M + Time*CTRL_M + REAP_1*CTRL_M,
random = ~ CTRLcln + Time + REAP_1 | ID,
main_wis, method = "ML", na.action = na.omit)
summary(intercept.slope.outcome)
summary(intercept.slope.outcome)
summary(intercept.slope.outcome)
anova(intercept.slope.outcome, intercept.outcome)
anova(intercept.slope.outcome, slope.outcome)
