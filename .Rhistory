library(readr)
archery_data <- read_csv("archery_data.csv")
View(archery_data)
ibrary(tidyverse)
library(tidyverse)
library(psych)
library(lavaan)
library(semPlot)
org_dat = read.csv("archery_data.csv")
org_dat = read.csv("archery_data.csv")
head(org_dat)
org_dat = read.csv("archery_data.csv")
org_dat = read.csv("archery_data.csv")
head(org_dat)
#mean of heart rate
heart = c('heart_before1', 'heart_before2', 'heart_before3', 'heart_before4',
'heart_before5', 'heart_before6', 'heart_before7', 'heart_before8',
'heart_before9','heart_before10','heart_before11','heart_before12')
org_dat %>%
mutate(mean_heart = rowMeans(cur_data()[,heart], na.rm=T)) -> mean_dat
summary(lm(score ~ mean_heart,data = mean_dat))
summary(lm(score ~ mean_heart + age + female + worldranking + rankinground_rank
+ stage + set_number + shoot_order + countdown + arrows,data = mean_dat))
aa <- lm(score ~ mean_heart + factor(match_name_id),data=mean_dat)
summary(aa)
#model3
model3 <- 'level: 1
score ~ mean_heart
level: 2
score ~~ score
'
fit3 <- sem(model = model3, data = mean_dat, cluster = "match_name_id")
fit3 <- sem(model = model3, estimator = "ML", missing = "fiml",
cluster = "match_name_id", data = mean_dat, meanstructure = T)
summary(fit3, fit.measures = T, standardized = T)
#model4
model4 <- 'level: 1
score ~ mean_heart +  set_number + shoot_order + countdown + arrows
level: 2
score ~ mean_heart + age + female + worldranking + rankinground_rank
'
fit4 <- sem(model = model4, data = mean_dat, estimator = "ML", missing = "fiml", cluster = "match_name_id")
summary(fit4, fit.measures = T, standardized = T)
#model5
model5 <- 'level: 1
score ~ mean_heart
mean_heart ~ set_number + shoot_order + countdown + arrows
level: 2
score ~ age + female + worldranking + rankinground_rank
'
fit5 <- sem(model = model5, data = mean_dat, estimator = "ML", missing = "fiml", cluster = "match_name_id")
summary(fit5, fit.measures = T, standardized = T)
#model6
model6 <- 'level: 1
score ~ mean_heart + set_number + shoot_order + countdown + arrows
level: 2
score ~ stage + age + female + worldranking + rankinground_rank
'
fit6 <- sem(model = model6, data = mean_dat, estimator = "ML", missing = "fiml", cluster = "match_name_id")
fit6 <- sem(model = model6, data = mean_dat, estimator = "ML", missing = "fiml", cluster = "match_name_id")
fit6 <- sem(model = model6, data = mean_dat, estimator = "ML", missing = "fiml", cluster = "match_name_id")
summary(fit6, fit.measures = T, standardized = T)
fit5 <- sem(model = model5, data = mean_dat, cluster = "match_name_id")
summary(fit5, fit.measures = T, standardized = T)
#model6
model6 <- 'level: 1
score ~ mean_heart + set_number + shoot_order + countdown + arrows
level: 2
score ~ stage + age + female + worldranking + rankinground_rank
'
fit6 <- sem(model = model6, data = mean_dat, cluster = "match_name_id")
summary(fit6, fit.measures = T, standardized = T)
fit5.5 <- sem(model = model5, data = mean_dat, estimator = "ML", missing = "fiml", cluster = "match_name_id")
summary(fit5.5)
summary(fit5.5, fitmeasures = T, standardized = T)
summary(fit5.5, fit.measures = T, standardized = T)
summary(fit5.5, fit.measures = T, standardized = T)
fit5.5 <- sem(model = model5, data = mean_dat, estimator = "ML", missing = "fiml", cluster = "match_name_id")
summary(fit5.5, fit.measures = T, standardized = T)
summary(fit5, fit.measures = T, standardized = T)
summary(fit5.5, fit.measures = T, standardized = T)
## main effect analysis
mainhr <- read_csv("scales_datafile_v3long_rev.csv")
##let's create time variables##
library(tidyverse)
library(lavaan)
library(psych)
## main effect analysis
mainhr <- read_csv("scales_datafile_v3long_rev.csv")
edit(mainhr)
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = apply(2, function(x) ifelse(time<0, x==time, 0))) -> mainHr
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = apply(2, function(x) ifelse(X==time|time<0, x==time, 0))) -> mainHr
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = apply(2, function(x) ifelse(x==time|x<0, x==time, 0))) -> mainHr
rlang::last_trace()
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = apply(2, function(x) ifelse(x==time|x<0, x==time, 0))) -> mainHr
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = apply(2, function(x) ifelse(x<0, x==time, 0))) -> mainHr
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = ifelse(time<0, time, 0))) -> mainHr
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = ifelse(time<0, time, 0)) -> mainHr
edit(mainHr)
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = ifelse(time<0, time, 0), preHh = ifelse(time<0, time, 0),
postHw = ifelse(time>0, time, 0), postHh = ifelse(time>0, time, 0))-> mainHr
edit(mainHr)
mainhr %>% mutate(preHw = ifelse(time<0, Wife*time, 0), preHh = ifelse(time<0, Husb*time, 0),
postHw = ifelse(time>0, Wife*time, 0), postHh = ifelse(time>0, Husb*time, 0))-> mainHr
edit(mainHr)
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = ifelse(time<0, Wife*time, 0), preHh = ifelse(time<0, Husb*time, 0),
postHw = ifelse(time>0, Wife*time, 0), postHh = ifelse(time>0, Husb*time, 0)
JJump = ifelse(time>0,1,0))-> mainHr #귀찮아서 Wife, Husb 곱하는 절차를 합침.
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = ifelse(time<0, Wife*time, 0), preHh = ifelse(time<0, Husb*time, 0),
postHw = ifelse(time>0, Wife*time, 0), postHh = ifelse(time>0, Husb*time, 0),
JJump = ifelse(time>0,1,0))-> mainHr #귀찮아서 Wife, Husb 곱하는 절차를 합침.
edit(mainHr)
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = ifelse(time<0, Wife*time, 0), preHh = ifelse(time<0, Husb*time, 0),
postHw = ifelse(time>0, Wife*time, 0), postHh = ifelse(time>0, Husb*time, 0),
WJump = ifelse(time>0,1,0), HJump = ifelse(time>0,1,0))-> mainHr #귀찮아서 Wife, Husb 곱하는 절차를 합침.
edit(mainHr)
View(mainhr)
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = ifelse(time<0, Wife*time, 0), preHh = ifelse(time<0, Husb*time, 0),
postHw = ifelse(time>0, Wife*time, 0), postHh = ifelse(time>0, Husb*time, 0),
WJump = ifelse(time>0,Wife*1,0), HJump = ifelse(time>0,Husb*1,0))-> mainHr #귀찮아서 Wife, Husb 곱하는 절차를 합침.
View(mainHr)
View(mainHr)
#dual-intercept piecewise regression_mixed
lm(relsat ~ 1*Husb + preHh + HJump + postHh, data=mainHr)
#dual-intercept piecewise regression_mixed
summary(lm(relsat ~ 1*Husb + preHh + HJump + postHh, data=mainHr))
summary(lm(relsat ~ 1*Wife + preHw + WJump + postHw, data=mainHr)) #아내내
#남편, 아내 동시에
summary(lm(relsat ~ 1*Husb + preHh + HJump + postHh +
1*Wife + preHw + WJump + postHw, data=mainHr))
##let's create time variables##
library(tidyverse)
library(lavaan)
library(psych)
hurri <- read_csv("scales_datafile_rev.csv")
# 변수별 결측치
hurri %>%
select(hrelsat5, hrelsat6, hrelsat7, wrelsat5, wrelsat6, wrelsat7) %>% data.frame() -> na_time
# colSums(is.na(na_time))
NN<- rowSums(is.na(na_time))
# 위의 64쌍의 부부를 구분하는 더미변수 생성(개수만 센거라 위 데이터로 가능할지 모르겠다)
hurri %>%
mutate(NN = replace(NN, rowSums(is.na(na_time)) == 6, 1)) %>%
mutate(NN = replace(NN, rowSums(is.na(na_time)) != 6, 0))-> hurri_na #success~*^0^* replace 함수로 특정 열의 값 대체
hurri_na %>% filter(NN==1) %>% count()
# NN 변수로 두 부부집단의 초기 관계만족도 차이 검정(t-test)
t.test(hrelsat1 ~ NN, hurri_na, var.equal=TRUE)
t.test(wrelsat1 ~ NN, hurri_na, var.equal=TRUE)
# 사건 직전 social support, perceived stress 차이 검정
t.test(hps3 ~ NN, hurri_na, var.equal=TRUE)
t.test(wps3 ~ NN, hurri_na, var.equal=TRUE)
t.test(hsupp3 ~ NN, hurri_na, var.equal=TRUE)
t.test(wsupp3 ~ NN, hurri_na, var.equal=TRUE)
#기술통계표 만들기
hurri_na %>%
select(hrelsat1, hrelsat2, hrelsat3, hrelsat5,
hrelsat6, hrelsat7, hexposure, hps3, hsupp3) %>% mean() -> table
summary(hurri_na)
hurri_na$hrelsat1
table()
## main effect analysis
mainhr <- read_csv("scales_datafile_v3long_rev.csv")
# 시간변수 만들기: pre-hurricane slope, post-hurricane slope, jump to use in piecewise regression
mainhr %>% mutate(preHw = ifelse(time<0, Wife*time, 0), preHh = ifelse(time<0, Husb*time, 0),
postHw = ifelse(time>0, Wife*time, 0), postHh = ifelse(time>0, Husb*time, 0),
WJump = ifelse(time>0,Wife*1,0), HJump = ifelse(time>0,Husb*1,0))-> mainHr #귀찮아서 Wife, Husb 곱하는 절차를 합침.
#dual-intercept piecewise regression_mixed
summary(lm(relsat ~ 1*Husb + preHh + HJump + postHh, data=mainHr)) #남편
summary(lm(relsat ~ 1*Wife + preHw + WJump + postHw, data=mainHr)) #아내
#남편, 아내 동시에
summary(lm(relsat ~ 1*Husb + preHh + HJump + postHh +
1*Wife + preHw + WJump + postHw, data=mainHr))
View(mainHr)
sem(relsatH ~ 1*Husb + preHh + HJump + postHh
relsatW ~ 1*Wife + preHw + WJump + postHw
model1 <- 'relsatH ~ 1*Husb + preHh + HJump + postHh
relsatW ~ 1*Wife + preHw + WJump + postHw
relsatH ~~ resatW'
sem(model = model1, estimator = "ML", missing = "fiml", data = mainHr, meanstructure=T)
model1 <- 'relsatH =~ 1*Husb + preHh + HJump + postHh
relsatW =~ 1*Wife + preHw + WJump + postHw
relsatH ~~ resatW'
sem(model = model1, estimator = "ML", missing = "fiml", data = mainHr, meanstructure=T)
model1 <- 'relsat =~ 1*Husb + preHh + HJump + postHh
relsat =~ 1*Wife + preHw + WJump + postHw
relsatH ~~ resatW'
sem(model = model1, estimator = "ML", missing = "fiml", data = mainHr, meanstructure=T)
model1 <- 'relsat =~ 1*Husb + preHh + HJump + postHh
relsat =~ 1*Wife + preHw + WJump + postHw
'
sem(model = model1, estimator = "ML", missing = "fiml", data = mainHr, meanstructure=T)
model1 <- 'relsat ~ 1*Husb + preHh + HJump + postHh
relsat ~ 1*Wife + preHw + WJump + postHw
'
sem(model = model1, estimator = "ML", missing = "fiml", data = mainHr, meanstructure=T)
summary(sem(model = model1, estimator = "ML", missing = "fiml", data = mainHr, meanstructure=T))
